syntax = "proto3";

package auth.v1;

import "google/api/annotations.proto";

option go_package = "api/auth/v1;v1";

// 登录请求通用结构
service AuthService {
  // 手机号登录
  rpc LoginWithPhone (LoginWithPhoneRequest) returns (LoginResponse) {
    option (google.api.http) = {
      post: "/user/v1/login_with_phone"
      body: "*"
    };
  };
  // Facebook登录
  rpc LoginWithFacebook (LoginWithFacebookRequest) returns (LoginResponse){
    option (google.api.http) = {
      post: "/user/v1/login_with_facebook"
      body: "*"
    };
  };
  // Apple登录
  rpc LoginWithApple (LoginWithAppleRequest) returns (LoginResponse){
    option (google.api.http) = {
      post: "/user/v1/login_with_apple"
      body: "*"
    };
  };
  // Google登录
  rpc LoginWithGoogle (LoginWithGoogleRequest) returns (LoginResponse){
    option (google.api.http) = {
      post: "/user/v1/login_with_google"
      body: "*"
    };
  };
  // Snapchat登录
  rpc LoginWithSnapchat (LoginWithSnapchatRequest) returns (LoginResponse){
    option (google.api.http) = {
      post: "/user/v1/login_with_snapchat"
      body: "*"
    };
  };
}

message LoginWithPhoneRequest {
  string phone_number = 1;
  string verification_code = 2;
}

message LoginWithFacebookRequest {
  string access_token = 1;
}

message LoginWithAppleRequest {
  string id_token = 1;
  string nonce = 2;
}

message LoginWithGoogleRequest {
  string id_token = 1;
}

message LoginWithSnapchatRequest {
  string access_token = 1;
}

message LoginResponse {
  string token = 1;
  bool is_new_user = 2;
  UserInfo user_info = 3;
}

message UserInfo {
  string id = 1;
  string name = 2;
  string avatar = 3;
  string phone = 4;
  string email = 5;
}
